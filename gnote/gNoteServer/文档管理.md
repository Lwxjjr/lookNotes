## 文档密码

优先级： 角色文档密码 > 角色密码  
如果pwd == ""，角色密码 == ""，不认为它开启了密码  
用户登录，同时在用户-密码-文档表（user=pwd-doc)中有记录，免密

---
## 文档试看

```go
DocSplitSign = "---===---"
```

### 文档试看内容
FreeContent != ""，认为开启了试看  
通过优先级反向查看试看内容  
1. 有分隔符，返回内容为split分割后的_list[0]
2. 文档内容
3. 角色文档内容
```go
// 分割符判断  
isDocFree := strings.Contains(doc.Content, global.DocSplitSign)  
var content = strings.ReplaceAll(doc.Content, global.DocSplitSign, "") // 正文  
var freeContent string                                                 // 试看内容  
// 赋值文档内容  
if isDocFree {  
    _list := strings.Split(doc.Content, global.DocSplitSign)  
    freeContent = _list[0] // 在分隔符前面的是试看  
}  
  
if roleDoc.FreeContent != nil {  
    response.IsSee = true  
    // 优先级：角色文档试看  > 文档试看字段 > 文档按照特殊字符分隔的试看  
    // 由小到大设置  
    if doc.FreeContent != "" {  
       freeContent = doc.FreeContent  
    }  
    if *roleDoc.FreeContent != "" {  
       freeContent = *roleDoc.FreeContent  
    }  
}
```

### 文档返回内容，取决密码试看  
1. 有试看 -> response.Content = freeContent
2. 有密码，无试看 -> response.Content = ""
3. 无密码，无试看 -> response.Content = content

---


找到子文档的结构：
![[Pasted image 20250412233026.png|236]]

树一维化的结构：
当然点开里面还是有Child
![[Pasted image 20250412233103.png|244]]