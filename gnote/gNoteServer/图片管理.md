# 图片上传
```go
// 拿到 key为 file 的文件
// file:*multipart.FileHeader，是文件的元数据
file, _ := c.FormFile("file")
// 上传文件到指定的路径
c.SaveUploadedFile(file, savePath)
```

# 1. 白名单
```go
// image_upload.go

var ImageWhiteList = []string{  
    "jpg",  
    "png",  
    "jpeg",  
    "gif",  
    "svg",  
    "webp",  
}

func InImageWhiteList(fileName string, whitelist []string) bool {  
    // 截取文件后缀  
    _list := strings.Split(fileName, ".")  
    // xxx  
    if len(_list) < 2 {  
       return false  
    }  
    // 取最后一位转小写  
    suffix := strings.ToLower(_list[len(_list)-1])  
    for _, s := range whitelist {  
       if suffix == s {  
          return true  
       }  
    }  
    return false  
}
```

# 2. 文件大小
```go
if fileHeader.Size > int64(2*1024*1024) {  
    res.FailWithMsg("图片大小超出限制", c)  
    return  
}
```

# 3. 重复文件判断
错误：
```go
file, _ := fileHeader.Open()
byteData, _ := io.ReadAll(file)
hashString := hash.MD5(byteData)

err = c.SaveUploadedFile(fileHeader, savePath)

```

```go
func (c *Context) SaveUploadedFile(file *multipart.FileHeader, dst string) error {  
    src, err := file.Open()  
    if err != nil {  
       return err  
    }  
    defer src.Close()
    ...
}
```
因为在 SaveUploadedFile还要打开一次文件，可能就有问题

```go

```